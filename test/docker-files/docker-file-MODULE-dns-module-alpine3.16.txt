FROM alpine:3.16
MAINTAINER Jean Gabes <naparuba@gmail.com>

ADD        test/docker-helper/  /
RUN        /apk_add bash
RUN        /apk_add python3
ENV        PYTHON_EXE=/usr/bin/python3

RUN        /apk_add less
RUN        /apk_add py3-jinja2
RUN        /apk_add py3-crypto
RUN        /apk_add musl-dev
RUN        /apk_add py3-setuptools
RUN        /apk_add leveldb
RUN        /apk_add py3-simplejson
RUN        /apk_add py3-setproctitle
RUN        /apk_add py3-psutil
RUN        /apk_add py3-yaml


# DNS: need dig
RUN        /apk_add bind-tools

ADD        . /root/opsbro-oss


WORKDIR    /root/opsbro-oss

RUN        $PYTHON_EXE setup.py install


ENTRYPOINT     test/test_module_dns.sh
