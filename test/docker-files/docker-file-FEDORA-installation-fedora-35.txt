FROM fedora:35
MAINTAINER Jean Gabes <naparuba@gmail.com>

ADD        test/docker-helper/  /

# NOTE: there is a strange bug on travis, cannot resolv mirrors.fedoraproject.org so put 209.132.190.2
RUN        printf "\n209.132.190.2   mirrors.fedoraproject.org\n" >> /etc/hosts

RUN        /dnf_install python

# For the test
RUN        /dnf_install procps

ENV        TEST_PACKAGE_NAME_VIRTUAL=vi
# But need to delete it first as it is installed by default
RUN        /yum_remove vim-minimal

ADD        . /root/opsbro-oss

ENTRYPOINT    test/test_one_linux_installation.sh  && test/assert_group.sh "fedora"
WORKDIR       /root/opsbro-oss
