version: '3'

# NOTE:
# 1 & 2: higher zone, exchange with private
# 3: lower zone: exchange with public with 1 & 2

services:
  node1:
    build:
       context: ../..
       dockerfile: test/docker-files/docker-file-DUO13-gossip-public-private-addr-node1.txt
       args:
          MY_PYTHON_VERSION: "${MY_PYTHON_VERSION}"
    networks:
       - gossip-separate-networks-private
       - gossip-separate-networks-public
    cap_add:
       - ALL

  node2:
    build:
       context: ../..
       dockerfile: test/docker-files/docker-file-DUO13-gossip-public-private-addr-node2.txt
       args:
          MY_PYTHON_VERSION: "${MY_PYTHON_VERSION}"
    networks:
       - gossip-separate-networks-private
       - gossip-separate-networks-public
    cap_add:
       - ALL

  node3:
    build:
       context: ../..
       dockerfile: test/docker-files/docker-file-DUO13-gossip-public-private-addr-node3.txt
       args:
          MY_PYTHON_VERSION: "${MY_PYTHON_VERSION}"
    networks:
       - gossip-separate-networks-public
    cap_add:
       - ALL


networks:
  gossip-separate-networks-private:
      driver: bridge
      ipam:
         driver: default
         config:
            - subnet: 10.10.10.0/24

  gossip-separate-networks-public:
      driver: bridge
      ipam:
         driver: default
         config:
            - subnet: 192.168.100.0/24
